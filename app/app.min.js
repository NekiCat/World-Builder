/// <reference path="../typings/index.d.ts" />
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
var WorldBuilder
!function(e){var t
!function(e){function t(e,t,r,o){angular.module("WorldBuilder").config(["$routeProvider",function(t){t.when(r,{templateUrl:o,controller:e})}]).controller(e,t)}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"==e?t:3&t|8
return r.toString(16)})}e.registerAngularController=t,e.createGUID=r}(t=e.Util||(e.Util={})),angular.module("WorldBuilder",["ngRoute","ngStorage"]).config(["$locationProvider","$routeProvider",function(e,t){e.hashPrefix("!"),t.otherwise({redirectTo:"/projects"})}]).filter("escape",["$window",function(e){return e.encodeURIComponent}]).directive("wbClickOff",["$parse","$document",function(e,t){return{compile:function(r,o){var n=e(o.wbClickOff)
return function(e,r,o){r.bind("click",function(e){e.stopPropagation()}),angular.element(t[0].body).bind("click",function(t){e.$apply(function(){n(e,{$event:t})})})}}}}]).directive("wbEnter",function(){return function(e,t,r){t.bind("keydown keypress",function(t){console.log("keycode = %d",t.which),13===t.which&&(e.$apply(function(){e.$eval(r.wbEnter,{event:t})}),t.preventDefault())})}})}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(){this.guid=e.Util.createGUID(),this.name="New Character",this.deleted=!1}return t}()
e.Character=t}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(){this.guid=e.Util.createGUID(),this.name="New Event",this.deleted=!1}return t}()
e.Event=t}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(){this.guid=e.Util.createGUID(),this.name="New Location",this.deleted=!1}return t}()
e.Location=t}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function e(){}return e}()
e.Icon=t
var r=function(){function t(){this.guid=e.Util.createGUID(),this.name="New Project",this.deleted=!1,this.characters=[],this.locations=[],this.events=[],this.terms=[]}return t}()
e.Project=r}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(){this.guid=e.Util.createGUID(),this.name="New Term",this.deleted=!1}return t}()
e.Term=t}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t
!function(e){function t(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0)
var o
Array.isArray(e)?(o=e[0],t=e[1],r=e[2]):o=e
var n,i,c=Math.max(o,t,r),l=Math.min(o,t,r),a=(c+l)/2
if(c===l)n=i=0
else{var u=c-l
switch(i=a>.5?u/(2-c-l):u/(c+l),c){case o:n=(t-r)/u+(t<r?6:0)
break
case t:n=(r-o)/u+2
break
case r:n=(o-t)/u+4}n/=6}return[n,i,a]}function r(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0)
var o
Array.isArray(e)?(o=e[0],t=e[1],r=e[2]):o=e
var n,i,c
if(0===t)n=i=c=0
else{var l=function(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e},a=r<.5?r*(1+t):r+t-r*t,u=2*r-a
n=l(u,a,o+1/3),i=l(u,a,o),c=l(u,a,o-1/3)}return[255*n,255*i,255*c]}e.rgbToHsl=t,e.hslToRgb=r}(t=e.Util||(e.Util={}))}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t
!function(e){function t(e,t){for(var r=new t,o=0,n=r.name;e.filter(function(e){return e.name.toLowerCase()==n.toLowerCase()}).length>0;)n=r.name+" ("+ ++o+")"
r.name=n,e.push(r)}function r(e,t){e.indexOf(t)>-1&&(t.deleted=!0)}function o(e){for(var t=e.length;t--;)e[t].deleted&&e.splice(t,1)}function n(e,t){t.deleted=!1}e.createNameable=t,e.removeStart=r,e.removeEnd=o,e.removeUndo=n}(t=e.Util||(e.Util={}))}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(t,r,o,n){var i=this
this.$scope=t,this.$scope.$storage=r.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===o.project})[0],this.$scope.project||n.path("/projects"),this.$scope.createItem=function(){return e.Util.createNameable(i.$scope.project.characters,e.Character)},this.$scope.removeItem=function(t){return e.Util.removeStart(i.$scope.project.characters,t)},this.$scope.removeUndo=function(t){return e.Util.removeUndo(i.$scope.project.characters,t)},this.$scope.$on("$locationChangeSuccess",function(){e.Util.removeEnd(t.project.characters),r.$apply()})}return t.$inject=["$scope","$localStorage","$routeParams","$location"],t}()
e.CharacterListController=t,e.Util.registerAngularController("CharacterListController",t,"/projects/:project/characters","views/characterList/characterList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(t,r,o,n){this.$scope=t,t.$storage=r.$default({projects:[]}),t.project=this.$scope.$storage.projects.filter(function(e){return e.guid===o.project})[0],t.project||n.path("/projects"),t.createItem=function(){return e.Util.createNameable(t.project.events,e.Event)},t.removeItem=function(r){return e.Util.removeStart(t.project.events,r)},t.removeUndo=function(r){return e.Util.removeUndo(t.project.events,r)},t.$on("$locationChangeSuccess",function(){e.Util.removeEnd(t.project.events),r.$apply()})}return t.$inject=["$scope","$localStorage","$routeParams","$location"],t}()
e.EventListController=t,e.Util.registerAngularController("EventListController",t,"/projects/:project/events","views/eventList/eventList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(t,r,o,n){this.$scope=t,t.$storage=r.$default({projects:[]}),t.project=t.$storage.projects.filter(function(e){return e.guid===o.project})[0],t.project||n.path("/projects"),t.createItem=function(){return e.Util.createNameable(t.project.locations,e.Location)},t.removeItem=function(r){return e.Util.removeStart(t.project.locations,r)},t.removeUndo=function(r){return e.Util.removeUndo(t.project.locations,r)},t.$on("$locationChangeSuccess",function(){e.Util.removeEnd(t.project.locations),r.$apply()})}return t.$inject=["$scope","$localStorage","$routeParams","$location"],t}()
e.LocationListController=t,e.Util.registerAngularController("LocationListController",t,"/projects/:project/locations","views/locationList/locationList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function e(e,t,r,o){this.$scope=e,this.$scope.$storage=t.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===r.project})[0],this.$scope.project||o.path("/projects")}return e.$inject=["$scope","$localStorage","$routeParams","$location"],e}()
e.ProjectController=t,e.Util.registerAngularController("ProjectController",t,"/projects/:project","views/project/project.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(t,r){this.$scope=t,t.$storage=r.$default({projects:[]}),t.createItem=function(){return e.Util.createNameable(t.$storage.projects,e.Project)},t.removeItem=function(r){return e.Util.removeStart(t.$storage.projects,r)},t.removeUndo=function(r){return e.Util.removeUndo(t.$storage.projects,r)},t.$on("$locationChangeSuccess",function(){e.Util.removeEnd(t.$storage.projects),r.$apply()})}return t.$inject=["$scope","$localStorage"],t}()
e.ProjectListController=t,e.Util.registerAngularController("ProjectListController",t,"/projects","views/projectList/projectList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function t(t,r,o,n){this.$scope=t,t.$storage=r.$default({projects:[]}),t.project=t.$storage.projects.filter(function(e){return e.guid===o.project})[0],t.project||n.path("/projects"),t.createItem=function(){return e.Util.createNameable(t.project.terms,e.Term)},t.removeItem=function(r){return e.Util.removeStart(t.project.terms,r)},t.removeUndo=function(r){return e.Util.removeUndo(t.project.terms,r)},t.$on("$locationChangeSuccess",function(){e.Util.removeEnd(t.project.terms),r.$apply()})}return t.$inject=["$scope","$localStorage","$routeParams","$location"],t}()
e.TermListController=t,e.Util.registerAngularController("TermListController",t,"/projects/:project/terms","views/termList/termList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var t=function(){function e(e,t,r,o){this.$scope=e,this.$scope.$storage=t.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===r.project})[0],this.$scope.project||o.path("/projects")}return e.$inject=["$scope","$localStorage","$routeParams","$location"],e}()
e.TimelineController=t,e.Util.registerAngularController("TimelineController",t,"/projects/:project/timeline","views/timeline/timeline.html")}(WorldBuilder||(WorldBuilder={}))
