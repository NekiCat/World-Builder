/// <reference path="../typings/index.d.ts" />
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
/// <reference path="../../../typings/index.d.ts"/>
var WorldBuilder
!function(e){var r
!function(e){function r(e,r,t,o){angular.module("WorldBuilder").config(["$routeProvider",function(r){r.when(t,{templateUrl:o,controller:e})}]).controller(e,r)}function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,t="x"==e?r:3&r|8
return t.toString(16)})}e.registerAngularController=r,e.createGUID=t}(r=e.Util||(e.Util={})),angular.module("WorldBuilder",["ngRoute","ngStorage"]).config(["$locationProvider","$routeProvider",function(e,r){e.hashPrefix("!"),r.otherwise({redirectTo:"/projects"})}]).filter("escape",["$window",function(e){return e.encodeURIComponent}]).directive("wbClickOff",["$parse","$document",function(e,r){return{compile:function(t,o){var n=e(o.wbClickOff)
return function(e,t,o){t.bind("click",function(e){e.stopPropagation()}),angular.element(r[0].body).bind("click",function(r){e.$apply(function(){n(e,{$event:r})})})}}}}]).directive("wbEnter",function(){return function(e,r,t){r.bind("keydown keypress",function(r){console.log("keycode = %d",r.which),13===r.which&&(e.$apply(function(){e.$eval(t.wbEnter,{event:r})}),r.preventDefault())})}})}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(){this.guid=e.Util.createGUID(),this.name="New Character",this.deleted=!1}return r}()
e.Character=r}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(){this.guid=e.Util.createGUID(),this.name="New Event",this.deleted=!1}return r}()
e.Event=r}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(){this.guid=e.Util.createGUID(),this.name="New Location",this.deleted=!1}return r}()
e.Location=r}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function e(){}return e}()
e.Icon=r
var t=function(){function r(){this.guid=e.Util.createGUID(),this.name="New Project",this.deleted=!1,this.characters=[],this.locations=[],this.events=[],this.terms=[]}return r}()
e.Project=t}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(){this.guid=e.Util.createGUID(),this.name="New Term",this.deleted=!1}return r}()
e.Term=r}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r
!function(e){function r(e,r,t){void 0===r&&(r=0),void 0===t&&(t=0)
var o
Array.isArray(e)?(o=e[0],r=e[1],t=e[2]):o=e
var n,i,c=Math.max(o,r,t),l=Math.min(o,r,t),a=(c+l)/2
if(c===l)n=i=0
else{var u=c-l
switch(i=a>.5?u/(2-c-l):u/(c+l),c){case o:n=(r-t)/u+(r<t?6:0)
break
case r:n=(t-o)/u+2
break
case t:n=(o-r)/u+4}n/=6}return[n,i,a]}function t(e,r,t){void 0===r&&(r=0),void 0===t&&(t=0)
var o
Array.isArray(e)?(o=e[0],r=e[1],t=e[2]):o=e
var n,i,c
if(0===r)n=i=c=0
else{var l=function(e,r,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+6*(r-e)*t:t<.5?r:t<2/3?e+(r-e)*(2/3-t)*6:e},a=t<.5?t*(1+r):t+r-t*r,u=2*t-a
n=l(u,a,o+1/3),i=l(u,a,o),c=l(u,a,o-1/3)}return[255*n,255*i,255*c]}e.rgbToHsl=r,e.hslToRgb=t}(r=e.Util||(e.Util={}))}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r
!function(e){function r(e,r){for(var t=new r,o=0,n=t.name;e.filter(function(e){return e.name.toLowerCase()==n.toLowerCase()}).length>0;)n=t.name+" ("+ ++o+")"
t.name=n,e.push(t)}function t(e,r){e.indexOf(r)>-1&&(r.deleted=!0)}function o(e){for(var r=e.length;r--;)e[r].deleted&&e.splice(r,1)}function n(e,r){r.deleted=!1}e.createNameable=r,e.removeStart=t,e.removeEnd=o,e.removeUndo=n}(r=e.Util||(e.Util={}))}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function e(e,r,t,o){this.$scope=e,e.$storage=r.$default({projects:[]}),e.project=e.$storage.projects.filter(function(e){return e.guid===t.project})[0],e.project||o.path("/projects"),e.character=e.project.characters.filter(function(e){return e.guid===t.character})[0],e.character||o.path("/projects/"+e.project.guid)}return e.$inject=["$scope","$localStorage","$routeParams","$location"],e}()
e.CharacterController=r,e.Util.registerAngularController("CharacterController",r,"/projects/:project/characters/:character","views/character/character.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(r,t,o,n){var i=this
this.$scope=r,this.$scope.$storage=t.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===o.project})[0],this.$scope.project||n.path("/projects"),this.$scope.createItem=function(){return e.Util.createNameable(i.$scope.project.characters,e.Character)},this.$scope.removeItem=function(r){return e.Util.removeStart(i.$scope.project.characters,r)},this.$scope.removeUndo=function(r){return e.Util.removeUndo(i.$scope.project.characters,r)},this.$scope.$on("$locationChangeSuccess",function(){e.Util.removeEnd(r.project.characters),t.$apply()})}return r.$inject=["$scope","$localStorage","$routeParams","$location"],r}()
e.CharacterListController=r,e.Util.registerAngularController("CharacterListController",r,"/projects/:project/characters","views/characterList/characterList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(r,t,o,n){this.$scope=r,r.$storage=t.$default({projects:[]}),r.project=this.$scope.$storage.projects.filter(function(e){return e.guid===o.project})[0],r.project||n.path("/projects"),r.createItem=function(){return e.Util.createNameable(r.project.events,e.Event)},r.removeItem=function(t){return e.Util.removeStart(r.project.events,t)},r.removeUndo=function(t){return e.Util.removeUndo(r.project.events,t)},r.$on("$locationChangeSuccess",function(){e.Util.removeEnd(r.project.events),t.$apply()})}return r.$inject=["$scope","$localStorage","$routeParams","$location"],r}()
e.EventListController=r,e.Util.registerAngularController("EventListController",r,"/projects/:project/events","views/eventList/eventList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(r,t,o,n){this.$scope=r,r.$storage=t.$default({projects:[]}),r.project=r.$storage.projects.filter(function(e){return e.guid===o.project})[0],r.project||n.path("/projects"),r.createItem=function(){return e.Util.createNameable(r.project.locations,e.Location)},r.removeItem=function(t){return e.Util.removeStart(r.project.locations,t)},r.removeUndo=function(t){return e.Util.removeUndo(r.project.locations,t)},r.$on("$locationChangeSuccess",function(){e.Util.removeEnd(r.project.locations),t.$apply()})}return r.$inject=["$scope","$localStorage","$routeParams","$location"],r}()
e.LocationListController=r,e.Util.registerAngularController("LocationListController",r,"/projects/:project/locations","views/locationList/locationList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function e(e,r,t,o){this.$scope=e,this.$scope.$storage=r.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===t.project})[0],this.$scope.project||o.path("/projects")}return e.$inject=["$scope","$localStorage","$routeParams","$location"],e}()
e.ProjectController=r,e.Util.registerAngularController("ProjectController",r,"/projects/:project","views/project/project.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(r,t){this.$scope=r,r.$storage=t.$default({projects:[]}),r.createItem=function(){return e.Util.createNameable(r.$storage.projects,e.Project)},r.removeItem=function(t){return e.Util.removeStart(r.$storage.projects,t)},r.removeUndo=function(t){return e.Util.removeUndo(r.$storage.projects,t)},r.$on("$locationChangeSuccess",function(){e.Util.removeEnd(r.$storage.projects),t.$apply()})}return r.$inject=["$scope","$localStorage"],r}()
e.ProjectListController=r,e.Util.registerAngularController("ProjectListController",r,"/projects","views/projectList/projectList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function r(r,t,o,n){this.$scope=r,r.$storage=t.$default({projects:[]}),r.project=r.$storage.projects.filter(function(e){return e.guid===o.project})[0],r.project||n.path("/projects"),r.createItem=function(){return e.Util.createNameable(r.project.terms,e.Term)},r.removeItem=function(t){return e.Util.removeStart(r.project.terms,t)},r.removeUndo=function(t){return e.Util.removeUndo(r.project.terms,t)},r.$on("$locationChangeSuccess",function(){e.Util.removeEnd(r.project.terms),t.$apply()})}return r.$inject=["$scope","$localStorage","$routeParams","$location"],r}()
e.TermListController=r,e.Util.registerAngularController("TermListController",r,"/projects/:project/terms","views/termList/termList.html")}(WorldBuilder||(WorldBuilder={}))
var WorldBuilder
!function(e){var r=function(){function e(e,r,t,o){this.$scope=e,this.$scope.$storage=r.$default({projects:[]}),this.$scope.project=this.$scope.$storage.projects.filter(function(e){return e.guid===t.project})[0],this.$scope.project||o.path("/projects")}return e.$inject=["$scope","$localStorage","$routeParams","$location"],e}()
e.TimelineController=r,e.Util.registerAngularController("TimelineController",r,"/projects/:project/timeline","views/timeline/timeline.html")}(WorldBuilder||(WorldBuilder={}))
